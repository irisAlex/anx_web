/*! 
 Build based on gin-vue-admin 
 Time : 1713878256000 */
import{_ as e,a,o as l,c as t,b as o,d as r,w as u,K as s,L as i,g as n,f as d,t as p,A as m,e as c,j as v,k as _,E as w,p as k,h as f}from"./087AC4D233B64EB0index.js";import{E as h}from"./087AC4D233B64EB0dialog.js";import"./087AC4D233B64EB0overlay.js";import{E as b}from"./087AC4D233B64EB0upload2.js";import"./087AC4D233B64EB0progress.js";import{E as y}from"./087AC4D233B64EB0pagination.js";/* empty css                     */import"./087AC4D233B64EB0tag.js";import{E as g,a as B}from"./087AC4D233B64EB0select.js";import"./087AC4D233B64EB0scrollbar.js";/* empty css                      */import{E as C,a as D}from"./087AC4D233B64EB0table-column.js";import"./087AC4D233B64EB0checkbox.js";/* empty css                       */import{E}from"./087AC4D233B64EB0image-viewer.js";import{a as j,E as V}from"./087AC4D233B64EB0form-item.js";/* empty css                      */import{E as A}from"./087AC4D233B64EB0date-picker.js";import{c as x,d as U,e as z,f as S,g as q,b as I,q as O,u as Y}from"./087AC4D233B64EB0manage.js";import{f as J,t as N}from"./087AC4D233B64EB0stringFun.js";import{E as M}from"./087AC4D233B64EB0index23.js";import"./087AC4D233B64EB0isUndefined.js";import"./087AC4D233B64EB0cloneDeep.js";import"./087AC4D233B64EB0_baseClone.js";import"./087AC4D233B64EB0_Uint8Array.js";import"./087AC4D233B64EB0_initCloneObject.js";import"./087AC4D233B64EB0isEqual.js";import"./087AC4D233B64EB0hasIn.js";import"./087AC4D233B64EB0index22.js";import"./087AC4D233B64EB0strings.js";import"./087AC4D233B64EB0debounce.js";import"./087AC4D233B64EB0castArray.js";import"./087AC4D233B64EB0arrays.js";import"./087AC4D233B64EB0index28.js";const F=e=>(k("data-v-43b507f7"),e=e(),f(),e),T={class:"gva-search-box"},Z={slot:"reference",class:"name-wrapper"},K=F((()=>o("i",{class:"el-icon-time"},null,-1))),L={style:{"margin-left":"10px"}},G={class:"gva-pagination"},H={key:0},P={key:0},Q={key:0},R={key:0},W={key:0},X={key:0},$=F((()=>o("div",{slot:"tip",class:"el-upload__tip"},"只能上传jpg/png文件，且不超过500kb",-1))),ee={class:"dialog-footer"},ae=e(Object.assign({name:"Api"},{__name:"rework",setup(e){const k=e=>{if(0===e.code)return v({type:"success",message:"图片上传成功",showClose:!0}),Ae.value.push({name:e.data.file.name,url:e.data.file.url}),void(te.value.rework_attachment=JSON.stringify(Ae.value));v({type:"error",message:"图片上传失败",showClose:!0})},f=(e,a)=>{const l=a.indexOf(e);-1!==l&&fileList.splice(l,1),te.value.rework_attachment=JSON.stringify(a.value)},F=a(!1),ae="https://demo.gin-vue-admin.com:8888/",le=a([]),te=a({serialnumber:"",process_mode:"",department:"",mold:"",category:"",project:"",checkout_name:"",checkout_number:"",rework_number:0,rework_man_hour:0,rework_quantities:"",rework_process:"",rework_plan_date:"0001-01-01T00:00:00Z",rework_desc:"",rework_attachment:"",is_ncr:""}),oe=a([{value:"Just Do it",label:"Just Do it",type:"success"},{value:"A3",label:"A3",type:""},{value:"8D",label:"8D",type:"warning"}]),re=a([{value:"内部",label:"内部",type:"success"},{value:"外部",label:"外部",type:""},{value:"配做",label:"配做",type:"warning"}]),ue=a(""),se=a({path:[{required:!0,message:"请输入api路径",trigger:"blur"}],apiGroup:[{required:!0,message:"请输入组名称",trigger:"blur"}],method:[{required:!0,message:"请选择请求方式",trigger:"blur"}],description:[{required:!0,message:"请输入api介绍",trigger:"blur"}]}),ie=a(1),ne=a(0),de=a(10),pe=a([]),me=a({}),ce=()=>{me.value={}},ve=()=>{ie.value=1,de.value=10,Be()},_e=e=>{de.value=e,Be()},we=e=>{ie.value=e,Be()},ke=({prop:e,order:a})=>{e&&("ID"===e&&(e="id"),me.value.orderKey=N(e),me.value.desc="descending"===a),Be()},fe=a([]),he=a([]),be=a([]),ye=a([]);(async()=>{const e=await x({page:ie.value,pageSize:de.value,...me.value});0===e.code&&(fe.value=e.data.list)})();(async()=>{const e=await U({page:ie.value,pageSize:de.value,...me.value});0===e.code&&(he.value=e.data.list)})();(async()=>{const e=await z({page:ie.value,pageSize:de.value,...me.value});0===e.code&&(be.value=e.data.list)})();(async()=>{const e=await S({page:ie.value,pageSize:de.value,...me.value});0===e.code&&(ye.value=e.data.list)})();const ge=a("返工"),Be=async()=>{const e=await q({page:ie.value,pageSize:de.value,keyword:ge.value,orderKey:"id",desc:!0,...me.value});0===e.code&&(pe.value=e.data.list,ne.value=e.data.total,ie.value=e.data.page,de.value=e.data.pageSize)};Be();const Ce=e=>{le.value=e},De=a(null),Ee=a("查看返工"),je=a(!1),Ve=()=>{De.value.resetFields(),te.value={serialnumber:"",process_mode:"",department:"",mold:"",category:"",project:"",checkout_name:"",checkout_number:"",rework_number:0,rework_man_hour:0,rework_quantities:"",rework_process:"",rework_plan_date:"0001-01-01T00:00:00Z",rework_desc:"",rework_attachment:"",is_ncr:""},je.value=!1},Ae=a([]),xe=a([]),Ue=async(e,a)=>{const l=await I({id:e.ID});te.value=l.data.manage,""!==te.value.rework_attachment&&(Ae.value=JSON.parse(te.value.rework_attachment),xe.value=JSON.parse(te.value.rework_attachment)),(e=>{switch(e){case"look":Ee.value="查看返工",F.value=!1;break;case"modify":F.value=!0,Ee.value="修改返工"}ue.value=e,je.value=!0})(a)},ze=async(e,a)=>{0===(await O({id:e.ID,status:a})).code&&v({type:"success",message:"状态更新成功",showClose:!0}),Be()},Se=async()=>{De.value.validate((async e=>{if(e)if("modify"===ue.value){0===(await Y(te.value)).code&&v({type:"success",message:"编辑成功",showClose:!0}),Be(),Ve()}else v({type:"error",message:"未知操作",showClose:!0})}))};return(e,a)=>{const v=g,x=B,U=j,z=_,S=A,q=w,I=V,O=C,Y=M,N=E,le=D,ue=y,be=b,ye=h;return l(),t("div",null,[o("div",T,[r(I,{ref:"searchForm",inline:!0,model:me.value},{default:u((()=>[r(U,{label:"部门",style:{width:"200px"}},{default:u((()=>[r(x,{modelValue:me.value.department,"onUpdate:modelValue":a[0]||(a[0]=e=>me.value.department=e),placeholder:"北京安新"},{default:u((()=>[(l(!0),t(s,null,i(fe.value,(e=>(l(),n(v,{key:e.authorityId,label:e.authorityName,value:e.authorityName},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),r(U,{label:"类型",style:{width:"200px"}},{default:u((()=>[r(x,{modelValue:me.value.mold,"onUpdate:modelValue":a[1]||(a[1]=e=>me.value.mold=e),placeholder:"请选择"},{default:u((()=>[(l(!0),t(s,null,i(re.value,(e=>(l(),n(v,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),r(U,{label:"类别",style:{width:"200px"}},{default:u((()=>[r(x,{modelValue:me.value.category,"onUpdate:modelValue":a[2]||(a[2]=e=>me.value.category=e),placeholder:"请选择"},{default:u((()=>[(l(!0),t(s,null,i(he.value,(e=>(l(),n(v,{key:e.name,label:e.genre,value:e.genre},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),r(U,{label:"受检物名称",style:{width:"200px"}},{default:u((()=>[r(z,{modelValue:me.value.checkout_name,"onUpdate:modelValue":a[3]||(a[3]=e=>me.value.checkout_name=e),placeholder:"受检物名称"},null,8,["modelValue"])])),_:1}),r(U,{label:"受检物号",style:{width:"200px"}},{default:u((()=>[r(z,{modelValue:me.value.checkout_number,"onUpdate:modelValue":a[4]||(a[4]=e=>me.value.checkout_number=e),placeholder:"受检物号"},null,8,["modelValue"])])),_:1}),r(U,{label:"处理方式",style:{width:"200px"}},{default:u((()=>[r(x,{modelValue:me.value.process_mode,"onUpdate:modelValue":a[5]||(a[5]=e=>me.value.process_mode=e),placeholder:"请选择"},{default:u((()=>[(l(!0),t(s,null,i(oe.value,(e=>(l(),n(v,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),r(U,{label:"计划时间"},{default:u((()=>[r(S,{modelValue:me.value.rework_plan_date,"onUpdate:modelValue":a[6]||(a[6]=e=>me.value.rework_plan_date=e),type:"date",placeholder:"计划时间","value-format":"YYYY-MM-DDT15:04:05Z"},null,8,["modelValue"])])),_:1}),r(U,null,{default:u((()=>[r(q,{type:"primary",icon:"search",onClick:ve},{default:u((()=>[d("查询")])),_:1}),r(q,{icon:"refresh",onClick:ce},{default:u((()=>[d("重置")])),_:1})])),_:1})])),_:1},8,["model"])]),r(le,{data:pe.value,onSortChange:ke,onSelectionChange:Ce},{default:u((()=>[r(O,{align:"left",label:"ID","min-width":"150",prop:"ID",sortable:"custom"}),r(O,{align:"left",label:"编号","min-width":"150",prop:"serialnumber",sortable:"custom"}),r(O,{align:"left",label:"部门","min-width":"150",prop:"department",sortable:"custom"}),r(O,{align:"left",label:"类型","min-width":"150",prop:"mold",sortable:"custom"}),r(O,{align:"left",label:"类别","min-width":"150",prop:"category",sortable:"custom"}),r(O,{align:"left",label:"项目","min-width":"150",prop:"project",sortable:"custom"}),r(O,{align:"left",label:"受检物名称","min-width":"150",prop:"checkout_name",sortable:"custom"}),r(O,{align:"left",label:"受检物号","min-width":"150",prop:"checkout_number",sortable:"custom"}),r(O,{align:"left",label:"处理方式","min-width":"150",prop:"process_mode",sortable:"custom"}),r(O,{align:"left",label:"状态","min-width":"150",prop:"description",sortable:"custom"},{default:u((e=>[o("div",Z,[r(Y,{type:"1"===e.row.status?"success":"-1"===e.row.status?"danger":"info","disable-transitions":""},{default:u((()=>[d(p("1"===e.row.status?"同意":"-1"===e.row.status?"拒绝":"待审批"),1)])),_:2},1032,["type"])])])),_:1}),r(O,{align:"left",label:"数量","min-width":"150",prop:"rework_number",sortable:"custom"}),r(O,{align:"left",label:"工时","min-width":"150",prop:"rework_man_hour",sortable:"custom"}),r(O,{align:"left",label:"工料","min-width":"150",prop:"rework_quantities",sortable:"custom"}),r(O,{align:"left",label:"工序","min-width":"150",prop:"rework_process",sortable:"custom"}),r(O,{align:"left",label:"计划时间","min-width":"150",sortable:"custom"},{default:u((e=>[K,o("span",L,p(m(J)(e.row.rework_plan_date)),1)])),_:1}),r(O,{align:"left",label:"照片","min-width":"200",prop:"rework_attachment",sortable:"custom"},{default:u((e=>[(l(!0),t(s,null,i(JSON.parse(e.row.rework_attachment),(e=>(l(),n(N,{style:{width:"100px",height:"100px",display:"block",margin:"5px","box-shadow":"2px 2px 2px 1px rgba(0, 0, 0, 0.2)"},src:ae+e.url,"preview-src-list":[ae+e.url],"preview-teleported":!0,fit:"fill"},null,8,["src","preview-src-list"])))),256))])),_:1}),r(O,{align:"left",fixed:"right",label:"操作",width:"300"},{default:u((e=>[r(q,{icon:"check",type:"primary",link:"",onClick:a=>ze(e.row,"1")},{default:u((()=>[d("同意")])),_:2},1032,["onClick"]),r(q,{icon:"remove",type:"primary",link:"",onClick:a=>ze(e.row,"-1")},{default:u((()=>[d("拒绝")])),_:2},1032,["onClick"]),r(q,{icon:"view",type:"primary",link:"",onClick:a=>Ue(e.row,"look")},{default:u((()=>[d("查看")])),_:2},1032,["onClick"]),r(q,{icon:"view",type:"primary",link:"",onClick:a=>Ue(e.row,"modify")},{default:u((()=>[d("修改")])),_:2},1032,["onClick"]),r(q,{icon:"printer",type:"primary",link:"",onClick:a[7]||(a[7]=()=>{})},{default:u((()=>[d("打印")])),_:1})])),_:1})])),_:1},8,["data"]),o("div",G,[r(ue,{"current-page":ie.value,"page-size":de.value,"page-sizes":[10,30,50,100],total:ne.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:we,onSizeChange:_e},null,8,["current-page","page-size","total"])]),r(ye,{modelValue:je.value,"onUpdate:modelValue":a[14]||(a[14]=e=>je.value=e),"before-close":Ve,title:Ee.value,width:"40%"},{footer:u((()=>[o("div",ee,[F.value?(l(),n(q,{key:0,onClick:Ve},{default:u((()=>[d("取 消")])),_:1})):c("",!0),F.value?(l(),n(q,{key:1,type:"primary",onClick:Se},{default:u((()=>[d("确 定")])),_:1})):c("",!0)])])),default:u((()=>[r(I,{ref_key:"apiForm",ref:De,model:te.value,rules:se.value,inline:!0},{default:u((()=>[r(U,{label:"数量",prop:"rework_number",style:{width:"20%"}},{default:u((()=>[F.value?c("",!0):(l(),t("span",H,p(te.value.rework_number),1)),F.value?(l(),n(z,{key:1,placeholder:"数量",size:"mini",modelValue:te.value.rework_number,"onUpdate:modelValue":a[8]||(a[8]=e=>te.value.rework_number=e),modelModifiers:{number:!0}},null,8,["modelValue"])):c("",!0)])),_:1}),r(U,{label:"工时",prop:"rework_man_hour",style:{width:"20%"}},{default:u((()=>[F.value?c("",!0):(l(),t("span",P,p(te.value.rework_man_hour),1)),F.value?(l(),n(z,{key:1,placeholder:"工时",size:"mini",modelValue:te.value.rework_man_hour,"onUpdate:modelValue":a[9]||(a[9]=e=>te.value.rework_man_hour=e),modelModifiers:{number:!0}},null,8,["modelValue"])):c("",!0)])),_:1}),r(U,{label:"工料",prop:"rework_quantities",style:{width:"20%"}},{default:u((()=>[F.value?c("",!0):(l(),t("span",Q,p(te.value.rework_quantities),1)),F.value?(l(),n(z,{key:1,placeholder:"工料",size:"mini",modelValue:te.value.rework_quantities,"onUpdate:modelValue":a[10]||(a[10]=e=>te.value.rework_quantities=e)},null,8,["modelValue"])):c("",!0)])),_:1}),r(U,{label:"工序",prop:"rework_process",style:{width:"20%"}},{default:u((()=>[F.value?c("",!0):(l(),t("span",R,p(te.value.rework_process),1)),F.value?(l(),n(z,{key:1,placeholder:"工序",size:"mini",modelValue:te.value.rework_process,"onUpdate:modelValue":a[11]||(a[11]=e=>te.value.rework_process=e)},null,8,["modelValue"])):c("",!0)])),_:1}),r(U,{label:"返工计划完成时间",prop:"rework_plan_date",style:{width:"40%"}},{default:u((()=>[F.value?c("",!0):(l(),t("span",W,p(m(J)(te.value.rework_plan_date)),1)),F.value?(l(),n(S,{key:1,modelValue:te.value.rework_plan_date,"onUpdate:modelValue":a[12]||(a[12]=e=>te.value.rework_plan_date=e),type:"date",placeholder:"选择日期","value-format":"YYYY-MM-DDT15:04:05Z"},null,8,["modelValue"])):c("",!0)])),_:1}),r(U,{label:"返工描述",prop:"rework_desc",style:{width:"100%"}},{default:u((()=>[F.value?c("",!0):(l(),t("span",X,p(te.value.rework_man_hour),1)),F.value?(l(),n(z,{key:1,type:"textarea",placeholder:"请输入内容",modelValue:te.value.rework_desc,"onUpdate:modelValue":a[13]||(a[13]=e=>te.value.rework_desc=e),maxlength:"50","show-word-limit":"",rows:10},null,8,["modelValue"])):c("",!0)])),_:1}),r(U,{label:"返工证据",prop:"rework_attachment",style:{width:"100%"}},{default:u((()=>[F.value?c("",!0):(l(!0),t(s,{key:0},i(xe.value,(e=>(l(),n(N,{style:{width:"100px",height:"100px",display:"block",margin:"5px","box-shadow":"2px 2px 2px 1px rgba(0, 0, 0, 0.2)"},src:ae+e.url,"preview-src-list":[ae+e.url]},null,8,["src","preview-src-list"])))),256)),F.value?(l(),n(be,{key:1,action:"/api/fileUploadAndDownload/upload",multiple:"",limit:2,"file-list":Ae.value,"on-success":k,"show-file-list":"false","on-remove":f},{default:u((()=>[r(q,{size:"small",type:"primary"},{default:u((()=>[d("点击上传")])),_:1}),$])),_:1},8,["file-list"])):c("",!0)])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-43b507f7"]]);export{ae as default};
