/*! 
 Build based on gin-vue-admin 
 Time : 1713878256000 */
import{_ as e,a,o as l,c as t,b as r,d as o,w as s,K as i,L as u,g as p,f as d,t as n,A as m,e as c,j as v,k as _,E as f,p as g,h}from"./087AC4D233B64EB0index.js";import{E as y}from"./087AC4D233B64EB0dialog.js";import"./087AC4D233B64EB0overlay.js";import{E as b}from"./087AC4D233B64EB0upload2.js";import"./087AC4D233B64EB0progress.js";import{E as w}from"./087AC4D233B64EB0pagination.js";/* empty css                     */import"./087AC4D233B64EB0tag.js";import{E as B,a as C}from"./087AC4D233B64EB0select.js";import"./087AC4D233B64EB0scrollbar.js";/* empty css                      */import{E as k,a as D}from"./087AC4D233B64EB0table-column.js";import"./087AC4D233B64EB0checkbox.js";/* empty css                       */import{E}from"./087AC4D233B64EB0image-viewer.js";import{a as j,E as A}from"./087AC4D233B64EB0form-item.js";/* empty css                      */import{E as x}from"./087AC4D233B64EB0date-picker.js";import{c as V,d as S,e as U,f as z,g as I,b as O,q as Y,u as J}from"./087AC4D233B64EB0manage.js";import{f as N,t as q}from"./087AC4D233B64EB0stringFun.js";import{E as F}from"./087AC4D233B64EB0index23.js";import"./087AC4D233B64EB0isUndefined.js";import"./087AC4D233B64EB0cloneDeep.js";import"./087AC4D233B64EB0_baseClone.js";import"./087AC4D233B64EB0_Uint8Array.js";import"./087AC4D233B64EB0_initCloneObject.js";import"./087AC4D233B64EB0isEqual.js";import"./087AC4D233B64EB0hasIn.js";import"./087AC4D233B64EB0index22.js";import"./087AC4D233B64EB0strings.js";import"./087AC4D233B64EB0debounce.js";import"./087AC4D233B64EB0castArray.js";import"./087AC4D233B64EB0arrays.js";import"./087AC4D233B64EB0index28.js";const M=e=>(g("data-v-e4b071aa"),e=e(),h(),e),T={class:"gva-search-box"},Z={class:"gva-table-box"},K={slot:"reference",class:"name-wrapper"},G=M((()=>r("i",{class:"el-icon-time"},null,-1))),L={style:{"margin-left":"10px"}},H={class:"gva-pagination"},P={key:0},Q={key:0},R=M((()=>r("div",{slot:"tip",class:"el-upload__tip"},"只能上传jpg/png文件，且不超过500kb",-1))),W={class:"dialog-footer"},X=e(Object.assign({name:"Api"},{__name:"repair",setup(e){const g="https://demo.gin-vue-admin.com:8888/",h=a([]),M=a({serialnumber:"",process_mode:"",department:"",mold:"",category:"",project:"",checkout_name:"",checkout_number:"",checkout_number:"",repair_plan_date:"0001-01-01T00:00:00Z",repair_desc:"",repair_attachment:""}),X=a([{value:"Just Do it",label:"Just Do it",type:"success"},{value:"A3",label:"A3",type:""},{value:"8D",label:"8D",type:"warning"}]),$=a([{value:"内部",label:"内部",type:"success"},{value:"外部",label:"外部",type:""},{value:"配做",label:"配做",type:"warning"}]),ee=a(""),ae=a({path:[{required:!0,message:"请输入api路径",trigger:"blur"}],apiGroup:[{required:!0,message:"请输入组名称",trigger:"blur"}],method:[{required:!0,message:"请选择请求方式",trigger:"blur"}],description:[{required:!0,message:"请输入api介绍",trigger:"blur"}]}),le=a(1),te=a(0),re=a(10),oe=a([]),se=a({}),ie=a([]),ue=e=>{if(0===e.code)return v({type:"success",message:"图片上传成功",showClose:!0}),ie.value.push({name:e.data.file.name,url:e.data.file.url}),void(M.value.repair_attachment=JSON.stringify(ie.value));v({type:"error",message:"图片上传失败",showClose:!0})},pe=(e,a)=>{const l=a.indexOf(e);-1!==l&&a.splice(l,1),M.value.repair_attachment=JSON.stringify(a.value)},de=()=>{se.value={}},ne=()=>{le.value=1,re.value=10,be()},me=e=>{re.value=e,be()},ce=e=>{le.value=e,be()},ve=({prop:e,order:a})=>{e&&("ID"===e&&(e="id"),se.value.orderKey=q(e),se.value.desc="descending"===a),be()},_e=a([]),fe=a([]),ge=a([]),he=a([]);(async()=>{const e=await V({page:le.value,pageSize:re.value,...se.value});0===e.code&&(_e.value=e.data.list)})();(async()=>{const e=await S({page:le.value,pageSize:re.value,...se.value});0===e.code&&(fe.value=e.data.list)})();(async()=>{const e=await U({page:le.value,pageSize:re.value,...se.value});0===e.code&&(ge.value=e.data.list)})();(async()=>{const e=await z({page:le.value,pageSize:re.value,...se.value});0===e.code&&(he.value=e.data.list)})();const ye=a("返修"),be=async()=>{const e=await I({page:le.value,pageSize:re.value,keyword:ye.value,orderKey:"id",desc:!0,...se.value});0===e.code&&(oe.value=e.data.list,te.value=e.data.total,le.value=e.data.page,re.value=e.data.pageSize)};be();const we=e=>{h.value=e};a(!1),a(!1);const Be=a(null),Ce=a(!1),ke=a(""),De=a(!1),Ee=()=>{Be.value.resetFields(),M.value={serialnumber:"",department:"",process_mode:"",mold:"",category:"",project:"",checkout_name:"",checkout_number:"",checkout_number:"",repair_plan_date:"0001-01-01T00:00:00Z",repair_desc:"",repair_attachment:""},De.value=!1},je=a([]),Ae=async(e,a)=>{const l=await O({id:e.ID});M.value=l.data.manage,""!==M.value.repair_attachment&&(je.value=JSON.parse(M.value.repair_attachment),ie.value=JSON.parse(M.value.repair_attachment)),(e=>{switch(e){case"modify":ke.value="修改返修",Ce.value=!0;break;case"look":Ce.value=!1,ke.value="查看返修"}ee.value=e,De.value=!0})(a)},xe=async(e,a)=>{0===(await Y({id:e.ID,status:a})).code&&v({type:"success",message:"状态更新成功",showClose:!0}),be()},Ve=async()=>{Be.value.validate((async e=>{if(e)if("modify"===ee.value){0===(await J(M.value)).code&&v({type:"success",message:"编辑成功",showClose:!0}),be(),Ee()}else v({type:"error",message:"未知操作",showClose:!0})}))};return(e,a)=>{const v=B,h=C,V=j,S=_,U=x,z=f,I=A,O=k,Y=F,J=E,q=D,ee=w,ge=b,he=y;return l(),t("div",null,[r("div",T,[o(I,{ref:"searchForm",inline:!0,model:se.value},{default:s((()=>[o(V,{label:"部门",style:{width:"200px"}},{default:s((()=>[o(h,{modelValue:se.value.department,"onUpdate:modelValue":a[0]||(a[0]=e=>se.value.department=e),placeholder:"北京安新"},{default:s((()=>[(l(!0),t(i,null,u(_e.value,(e=>(l(),p(v,{key:e.authorityId,label:e.authorityName,value:e.authorityName},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),o(V,{label:"类型",style:{width:"200px"}},{default:s((()=>[o(h,{modelValue:se.value.mold,"onUpdate:modelValue":a[1]||(a[1]=e=>se.value.mold=e),placeholder:"请选择"},{default:s((()=>[(l(!0),t(i,null,u($.value,(e=>(l(),p(v,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),o(V,{label:"类别",style:{width:"200px"}},{default:s((()=>[o(h,{modelValue:se.value.category,"onUpdate:modelValue":a[2]||(a[2]=e=>se.value.category=e),placeholder:"请选择"},{default:s((()=>[(l(!0),t(i,null,u(fe.value,(e=>(l(),p(v,{key:e.name,label:e.genre,value:e.genre},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),o(V,{label:"受检物名称",style:{width:"200px"}},{default:s((()=>[o(S,{modelValue:se.value.checkout_name,"onUpdate:modelValue":a[3]||(a[3]=e=>se.value.checkout_name=e),placeholder:"受检物名称"},null,8,["modelValue"])])),_:1}),o(V,{label:"受检物号",style:{width:"200px"}},{default:s((()=>[o(S,{modelValue:se.value.checkout_number,"onUpdate:modelValue":a[4]||(a[4]=e=>se.value.checkout_number=e),placeholder:"受检物号"},null,8,["modelValue"])])),_:1}),o(V,{label:"处理方式",style:{width:"200px"}},{default:s((()=>[o(h,{modelValue:se.value.process_mode,"onUpdate:modelValue":a[5]||(a[5]=e=>se.value.process_mode=e),placeholder:"请选择"},{default:s((()=>[(l(!0),t(i,null,u(X.value,(e=>(l(),p(v,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),o(V,{label:"计划时间",style:{width:"200px"}},{default:s((()=>[o(U,{modelValue:se.value.repair_plan_date,"onUpdate:modelValue":a[6]||(a[6]=e=>se.value.repair_plan_date=e),type:"date",placeholder:"计划时间","value-format":"YYYY-MM-DDT15:04:05Z"},null,8,["modelValue"])])),_:1}),o(V,null,{default:s((()=>[o(z,{type:"primary",icon:"search",onClick:ne},{default:s((()=>[d("查询")])),_:1}),o(z,{icon:"refresh",onClick:de},{default:s((()=>[d("重置")])),_:1})])),_:1})])),_:1},8,["model"])]),r("div",Z,[o(q,{data:oe.value,onSortChange:ve,onSelectionChange:we},{default:s((()=>[o(O,{align:"left",label:"ID","min-width":"150",prop:"ID",sortable:"custom"}),o(O,{align:"left",label:"编号","min-width":"150",prop:"serialnumber",sortable:"custom"}),o(O,{align:"left",label:"部门","min-width":"150",prop:"department",sortable:"custom"}),o(O,{align:"left",label:"类型","min-width":"150",prop:"mold",sortable:"custom"}),o(O,{align:"left",label:"类别","min-width":"150",prop:"category",sortable:"custom"}),o(O,{align:"left",label:"受检物名称","min-width":"150",prop:"checkout_name",sortable:"custom"}),o(O,{align:"left",label:"受检物号","min-width":"150",prop:"checkout_number",sortable:"custom"}),o(O,{align:"left",label:"状态","min-width":"150",prop:"repair_desc",sortable:"custom"},{default:s((e=>[r("div",K,[o(Y,{type:"1"===e.row.status?"success":"-1"===e.row.status?"danger":"info","disable-transitions":""},{default:s((()=>[d(n("1"===e.row.status?"同意":"-1"===e.row.status?"拒绝":"待审批"),1)])),_:2},1032,["type"])])])),_:1}),o(O,{align:"left",label:"描述","min-width":"150",prop:"repair_desc",sortable:"custom"}),o(O,{align:"left",label:"附件及照片","min-width":"150",prop:"repair_attachment",sortable:"custom"},{default:s((e=>[(l(!0),t(i,null,u(JSON.parse(e.row.repair_attachment),(e=>(l(),p(J,{style:{width:"100px",height:"100px",display:"block",margin:"5px","box-shadow":"2px 2px 2px 1px rgba(0, 0, 0, 0.2)"},src:g+e.url,"preview-src-list":[g+e.url],"preview-teleported":!0,fit:"fill"},null,8,["src","preview-src-list"])))),256))])),_:1}),o(O,{align:"left",label:"计划时间","min-width":"150",prop:"repair_plan_date",sortable:"custom"},{default:s((e=>[G,r("span",L,n(m(N)(e.row.repair_plan_date)),1)])),_:1}),o(O,{align:"left",fixed:"right",label:"操作",width:"300"},{default:s((e=>[o(z,{icon:"check",type:"primary",link:"",onClick:a=>xe(e.row,"1")},{default:s((()=>[d("同意")])),_:2},1032,["onClick"]),o(z,{icon:"remove",type:"primary",link:"",onClick:a=>xe(e.row,"-1")},{default:s((()=>[d("拒绝")])),_:2},1032,["onClick"]),o(z,{icon:"view",type:"primary",link:"",onClick:a=>Ae(e.row,"look")},{default:s((()=>[d("查看")])),_:2},1032,["onClick"]),o(z,{icon:"view",type:"primary",link:"",onClick:a=>Ae(e.row,"modify")},{default:s((()=>[d("查看")])),_:2},1032,["onClick"]),o(z,{icon:"printer",type:"primary",link:"",onClick:a[7]||(a[7]=()=>{})},{default:s((()=>[d("打印")])),_:1})])),_:1})])),_:1},8,["data"]),r("div",H,[o(ee,{"current-page":le.value,"page-size":re.value,"page-sizes":[10,30,50,100],total:te.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:ce,onSizeChange:me},null,8,["current-page","page-size","total"])])]),o(he,{modelValue:De.value,"onUpdate:modelValue":a[10]||(a[10]=e=>De.value=e),"before-close":Ee,title:ke.value,width:"40%"},{footer:s((()=>[r("div",W,[Ce.value?(l(),p(z,{key:0,onClick:Ee},{default:s((()=>[d("取 消")])),_:1})):c("",!0),Ce.value?(l(),p(z,{key:1,type:"primary",onClick:Ve},{default:s((()=>[d("确 定")])),_:1})):c("",!0)])])),default:s((()=>[o(I,{ref_key:"apiForm",ref:Be,model:M.value,rules:ae.value,inline:!0},{default:s((()=>[o(V,{label:"返修计划完成时间",prop:"repair_plan_date",style:{width:"50%"}},{default:s((()=>[Ce.value?c("",!0):(l(),t("span",P,n(m(N)(M.value.repair_plan_date)),1)),Ce.value?(l(),p(U,{key:1,modelValue:M.value.repair_plan_date,"onUpdate:modelValue":a[8]||(a[8]=e=>M.value.repair_plan_date=e),type:"date",placeholder:"选择日期","value-format":"YYYY-MM-DDT15:04:05Z"},null,8,["modelValue"])):c("",!0)])),_:1}),o(V,{label:"返修描述",prop:"repair_desc",style:{width:"100%"}},{default:s((()=>[Ce.value?c("",!0):(l(),t("span",Q,n(M.value.repair_desc),1)),Ce.value?(l(),p(S,{key:1,type:"textarea",placeholder:"请输入内容",modelValue:M.value.repair_desc,"onUpdate:modelValue":a[9]||(a[9]=e=>M.value.repair_desc=e),maxlength:"50","show-word-limit":"",rows:10},null,8,["modelValue"])):c("",!0)])),_:1}),o(V,{label:"返修附件",prop:"repair_attachment",style:{width:"100%"}},{default:s((()=>[Ce.value?c("",!0):(l(!0),t(i,{key:0},u(je.value,(e=>(l(),p(J,{style:{width:"100px",height:"100px",display:"block",margin:"5px","box-shadow":"2px 2px 2px 1px rgba(0, 0, 0, 0.2)"},src:g+e.url,"preview-src-list":[g+e.url]},null,8,["src","preview-src-list"])))),256)),Ce.value?(l(),p(ge,{key:1,action:"/api/fileUploadAndDownload/upload",multiple:"",limit:2,"file-list":ie.value,"on-success":ue,"show-file-list":"false","on-remove":pe},{default:s((()=>[o(z,{size:"small",type:"primary"},{default:s((()=>[d("点击上传")])),_:1}),R])),_:1},8,["file-list"])):c("",!0)])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-e4b071aa"]]);export{X as default};
